# 待办事项提醒应用 - 功能演示

## 🎯 应用概述

这是一个使用 Kotlin 和 Jetpack Compose 开发的现代化待办事项提醒应用，类似于小米手机闹钟应用。

## ✨ 核心功能

### 1. 待办事项管理
- ✅ **创建待办事项**: 点击右下角的 `+` 按钮添加新的待办事项
- ✏️ **编辑待办事项**: 点击待办事项卡片上的编辑图标修改内容
- 🗑️ **删除待办事项**: 点击删除图标移除待办事项
- ✅ **启用/禁用**: 通过复选框快速启用或禁用待办事项

### 2. 提醒功能
- ⏰ **精确提醒**: 使用 `AlarmManager.setExactAndAllowWhileIdle()` 确保准时提醒
- 🔄 **重复周期**: 支持四种重复模式
  - 仅一次：在指定时间提醒一次
  - 每天：每天在同一时间提醒
  - 每周：每周在同一时间提醒
  - 每月：每月在同一时间提醒
- 📱 **系统通知**: 到达提醒时间时显示系统通知
- 🔄 **自动重置**: 设备重启后自动恢复所有启用的闹钟

### 3. 用户界面
- 🎨 **Material Design 3**: 采用最新的 Material Design 设计规范
- 📱 **响应式布局**: 适配不同屏幕尺寸
- 🌙 **深色模式**: 支持系统深色模式
- 🎯 **直观交互**: 简洁易用的操作界面

## 📱 界面展示

### 主界面
```
┌─────────────────────────────────────┐
│  待办事项提醒              ⋮        │
├─────────────────────────────────────┤
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ☐ 完成项目报告                │ │
│  │    需要包含本周的工作总结      │ │
│  │ 🕐 09:00  每天               │ │
│  │ 下次提醒: 今天 09:00          │ │
│  │                    [✎] [🗑]   │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ☐ 团队会议                    │ │
│  │    讨论下周的计划             │ │
│  │ 🕐 14:30  每周               │ │
│  │ 下次提醒: 明天 14:30          │ │
│  │                    [✎] [🗑]   │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ ☐ 提交月度报告                │ │
│  │    需要财务数据支持            │ │
│  │ 🕐 17:00  每月               │ │
│  │ 下次提醒: 01月15日 17:00      │ │
│  │                    [✎] [🗑]   │ │
│  └───────────────────────────────┘ │
│                                     │
│                              [+]    │
└─────────────────────────────────────┘
```

### 添加/编辑对话框
```
┌─────────────────────────────────────┐
│  添加待办事项                        │
├─────────────────────────────────────┤
│                                     │
│  标题                               │
│  ┌───────────────────────────────┐ │
│  │ 完成项目报告                   │ │
│  └───────────────────────────────┘ │
│                                     │
│  描述（可选）                       │
│  ┌───────────────────────────────┐ │
│  │ 需要包含本周的工作总结         │ │
│  │                               │ │
│  │                               │ │
│  └───────────────────────────────┘ │
│                                     │
│  [🕐] 提醒时间: 09:00              │
│                                     │
│  [⬇] 重复周期: 每天                │
│                                     │
│                        [取消] [保存]│
└─────────────────────────────────────┘
```

### 时间选择器
```
┌─────────────────────────────────────┐
│  选择时间                            │
├─────────────────────────────────────┤
│                                     │
│         ┌──────────┐                │
│         │  09      │                │
│         └──────────┘                │
│                                     │
│      ┌──┬──┬──┬──┬──┬──┐           │
│      │00│01│02│03│04│05│           │
│      ├──┼──┼──┼──┼──┼──┤           │
│      │06│07│08│09│10│11│           │
│      ├──┼──┼──┼──┼──┼──┤           │
│      │12│13│14│15│16│17│           │
│      ├──┼──┼──┼──┼──┼──┤           │
│      │18│19│20│21│22│23│           │
│      └──┴──┴──┴──┴──┴──┘           │
│                                     │
│         ┌──────────┐                │
│         │  00      │                │
│         └──────────┘                │
│                                     │
│                        [取消] [确定]│
└─────────────────────────────────────┘
```

### 通知界面
```
┌─────────────────────────────────────┐
│  🔔 待办事项提醒                    │
├─────────────────────────────────────┤
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 📋 完成项目报告                │ │
│  │    需要包含本周的工作总结      │ │
│  │                               │ │
│  │    [查看详情]                  │ │
│  └───────────────────────────────┘ │
│                                     │
│  ┌───────────────────────────────┐ │
│  │ 📋 团队会议                    │ │
│  │    讨论下周的计划             │ │
│  │                               │ │
│  │    [查看详情]                  │ │
│  └───────────────────────────────┘ │
│                                     │
└─────────────────────────────────────┘
```

## 🏗️ 技术架构

### MVVM 架构
```
┌─────────────────────────────────────┐
│           UI Layer                  │
│  (Jetpack Compose Components)       │
└──────────────┬──────────────────────┘
               │
┌──────────────▼──────────────────────┐
│       ViewModel Layer               │
│  (TodoViewModel - 状态管理)          │
└──────────────┬──────────────────────┘
               │
┌──────────────▼──────────────────────┐
│      Repository Layer               │
│  (TodoRepository - 数据仓库)         │
└──────────────┬──────────────────────┘
               │
┌──────────────▼──────────────────────┐
│       Data Layer                    │
│  (Room Database + AlarmManager)    │
└─────────────────────────────────────┘
```

### 核心组件说明

#### 1. 数据模型 (TodoItem.kt)
```kotlin
data class TodoItem(
    val id: Long = 0,
    val title: String,
    val description: String? = null,
    val reminderTime: LocalTime,
    val repeatCycle: RepeatCycle,
    val isEnabled: Boolean = true,
    val nextReminderTimestamp: Long? = null
)
```

#### 2. 数据库层
- **TodoDatabase**: Room 数据库，使用单例模式
- **TodoItemDao**: 数据访问对象，提供 CRUD 操作
- **Converters**: 类型转换器，处理 LocalTime 和 RepeatCycle

#### 3. 提醒调度器 (ReminderScheduler)
```kotlin
class ReminderScheduler(private val context: Context) {
    suspend fun scheduleReminder(todoItem: TodoItem)
    suspend fun cancelReminder(todoId: Long)
    suspend fun rescheduleAllReminders()
}
```

#### 4. 广播接收器
- **ReminderReceiver**: 接收闹钟触发，显示通知
- **BootReceiver**: 监听设备启动，恢复所有闹钟

#### 5. UI 组件
- **TodoScreen**: 主界面，显示待办列表
- **TodoItemCard**: 待办事项卡片
- **TodoEditDialog**: 添加/编辑对话框
- **TimePickerDialog**: 时间选择器

## 🚀 使用流程

### 添加待办事项
1. 点击主界面右下角的 `+` 按钮
2. 在对话框中输入标题（必填）
3. 可选输入描述
4. 点击"提醒时间"按钮选择时间
5. 点击"重复周期"选择提醒频率
6. 点击"保存"完成添加

### 编辑待办事项
1. 点击待办事项卡片上的编辑图标
2. 修改需要更新的字段
3. 点击"保存"完成编辑

### 删除待办事项
1. 点击待办事项卡片上的删除图标
2. 在确认对话框中点击"删除"

### 启用/禁用待办事项
1. 点击待办事项卡片左侧的复选框
2. 取消选中表示禁用，选中表示启用

## 📋 权限说明

应用需要以下权限：
- `SCHEDULE_EXACT_ALARM`: 设置精确闹钟
- `RECEIVE_BOOT_COMPLETED`: 接收开机广播
- `POST_NOTIFICATIONS`: 发送通知（Android 13+）
- `VIBRATE`: 震动提醒

## 🎯 核心特性

### 1. 精确提醒
使用 `AlarmManager.setExactAndAllowWhileIdle()` 确保在设备休眠时也能准时触发提醒。

### 2. 重复周期
智能计算下次提醒时间：
- **仅一次**: 如果时间已过，设置为明天
- **每天**: 如果时间已过，设置为明天
- **每周**: 如果时间已过，设置为下周
- **每月**: 如果时间已过，设置为下月

### 3. 设备重启恢复
监听 `BOOT_COMPLETED` 广播，自动恢复所有启用的闹钟。

### 4. 响应式 UI
使用 `StateFlow` 和 `collectAsState()` 实现响应式 UI 更新。

## 📦 依赖版本

- **Compose BOM**: 2023.10.01
- **Room**: 2.6.0
- **Lifecycle**: 2.6.2
- **Material 3**: 2023.10.01
- **Kotlin**: 1.8.22
- **Android Gradle Plugin**: 8.0.2

## 🔧 构建要求

- **Android Studio**: Hedgehog (2023.1.1) 或更高版本
- **JDK**: 17
- **Android SDK**: 34
- **Gradle**: 8.0+

## 📱 运行应用

### 在 Android Studio 中运行
1. 打开 Android Studio
2. 选择 "Open an Existing Project"
3. 选择项目目录 `d:\03-Work\todo`
4. 等待 Gradle 同步完成
5. 连接 Android 设备或启动模拟器
6. 点击 "Run" 按钮运行应用

### 使用命令行构建
```bash
# 清理构建
./gradlew clean

# 构建调试版本
./gradlew assembleDebug

# 安装到设备
./gradlew installDebug

# 运行测试
./gradlew test
```

## 🎨 主题定制

应用支持 Material Design 3 主题，可以在 `ui/theme/Color.kt` 中自定义颜色：

```kotlin
val Primary = Color(0xFF6200EE)
val PrimaryDark = Color(0xFF3700B3)
val Accent = Color(0xFF03DAC5)
```

## 🔄 后续优化建议

1. **分类功能**: 添加待办事项分类（工作、个人、学习等）
2. **自定义铃声**: 允许用户选择不同的提醒铃声
3. **统计功能**: 显示完成率、待办数量等统计信息
4. **导入/导出**: 支持数据导入导出功能
5. **桌面小组件**: 添加桌面小组件快速查看待办事项
6. **多语言**: 支持国际化
7. **云同步**: 支持多设备数据同步
8. **语音输入**: 支持语音输入待办事项

## 📝 注意事项

1. **Android 12+**: 需要请求 `SCHEDULE_EXACT_ALARM` 权限
2. **Android 13+**: 需要请求 `POST_NOTIFICATIONS` 权限
3. **Doze 模式**: 使用 `setExactAndAllowWhileIdle()` 确保在 Doze 模式下也能触发
4. **应用优化**: 确保应用在后台时不会占用过多资源

## 🎯 总结

这个待办事项提醒应用采用了现代化的 Android 开发技术栈，包括：
- ✅ Jetpack Compose 声明式 UI
- ✅ MVVM 架构模式
- ✅ Room 数据库持久化
- ✅ AlarmManager 精确提醒
- ✅ Material Design 3 设计规范
- ✅ Kotlin 协程异步处理
- ✅ 响应式数据流

应用提供了完整的待办事项管理功能，界面简洁美观，操作直观易用，是一个功能完善的 Android 应用示例。
